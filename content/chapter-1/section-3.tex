\section{\textsc{Измерения GPS}}

Существует три основных типа измерений GPS, которые доступны приёмнику: кодовые измерения (измерения псевдодальности), фазовые измерения (измерения фазы несущей) и измерения доплеровского сдвига частоты принятого сигнала.  
Все три типа измерений могут применяться для расчёта расстояния между спутником и приёмником, а доплеровский сдвиг также используется для определения скорости движения приёмника относительно спутника.

\subsection*{\textbf{Псевдодальность}}

Временная задержка между передачей и приёмом сигнала может быть определена при помощи корреляционного анализа (приёмник сравнивает код, полученный от спутника, с кодом, который сгенерировал сам, путём сдвига во времени пока корреляция не станет максимальной).
Поскольку электромагнитные волны распространяются со скоростью света в вакууме $c$, возможно определить расстояние (псевдодальность) между спутником $s$ и приёмником $r$ путём простого умножения временной задержки сигнала на $c$:
\begin{equation}
R_r^s=c(T_r-T^s)    
\end{equation}
где 
$T_r$ -- время приёма сигнала по часам приёмника;
$T^s$ -- время передачи сигнала по часам спутника. 

Если бы часы спутника и приёмника были идеально синхронизованы, то это была бы единственная необходимая информация для измерения псевдодальности.
Однако на практике это невозможно, поэтому для решения проблемы синхронизации используется приведение времени к общей системе GPST:
\begin{equation}
\begin{aligned}
&T_r=t_r+\delta_r \\
&T^s=t^s+\delta^s
\end{aligned}    
\end{equation}
где 
$t_r$ и $\delta_r$ -- время и смещение времени приёма сигнала относительно GPST;
$t^s$ и $\delta^s$ -- время и смещение времени передачи сигнала относительно GPST.   

В дополнении к смещению времени существуют многочисленные другие источники ошибок $e_r^s$, которые ухудшают точность измерения псевдодальности.
Таким образом, основная форма записи псевдодальности имеет вид:
\begin{equation}
\label{eq-pr}
R_r^s=\rho+c(\delta_r-\delta^s)+e_r^s    
\end{equation}
где 
$\rho=c(t_r-t^s)$ -- истинное расстояние между между спутником и приёмником.

Используя информацию о спутниковых часах, передаваемую в навигационном сообщении, можно учесть смещение времени спутника, т.е. $\delta^s\rightarrow 0$.
Аналогично, благодаря эфемеридам, можно приблизительно получить месторасположение спутника в декартовых геоцентрических координатах $x^s$, $y^s$ и $z^s$.
Поэтому истинное расстояние между спутником и приёмником вычисляется по теореме Пифагора: $\rho=\sqrt{(x_r-x^s)^2+(y_r-y^s)^2+(z_r-z^s)^2}$ где $x_r$, $y_r$ и $z_r$ -- декартовые геоцентрические координаты приёмника.
С учётом всего этого выражение \eqref{eq-pr} сводится к виду: 
\begin{equation}
\label{eq-pr2}
R_r^s=\sqrt{(x_r-x^s)^2+(y_r-y^s)^2+(z_r-z^s)^2}+c\delta_r+e_r^s    
\end{equation}

Точность измерений псевдодальности составляет около 1\% длины волны кода, что примерно соответствует 3 м для C/A кода и 0,3 м для P(Y) кода.

\subsection*{\textbf{Фаза несущей}}

Другим типом измерений GPS является фаза несущей, которая при дальнейших выкладках полагается безразмерной (т.е. измеряется в циклах, а не радианах).
Пусть в некоторый произвольный момент времени $t_0$ фаза волны равна $\phi_0$.
Соответственно, разность фаз в момент времени $t$ равна $\Delta \phi=\phi-\phi_0=(t-t_0)f$, где $f$ -- частота сигнала.  

Спутник передаёт сигнал, который имеет некоторую фазу $\phi^s(t)=\phi_0^s+\Delta \phi=\phi_0^s+(t-t_0)f^s$.
При получении сигнала приёмник генерирует его копию на той же частоте, но с другой фазой $\phi_r(t)=\phi_{0,r}+\Delta \phi=\phi_{0,r}+(t-t_0)f_r$.
Также часы спутника и приёмника привязаны к GPST, поэтому ещё имеются дополнительные сдвиги фаз, которые равны $f^s\delta^s$ и $f_r\delta_r$.
Следовательно, разность фаз между принятым сигналом и его копией равна:
\begin{equation}
\label{eq-dphi}
\begin{aligned}
\Delta \phi_r^s&=\phi_r(t)-\phi^s(t-\tau) \\
&=\left[\phi_{0,r}+(t-t_0)f_r+f_r\delta_r\right]-\left[\phi_0^s+(t-\tau-t_0)f^s+f^s\delta^s\right] \\
&=(f_r-f^s)t+f^s\tau+f_r\delta_r-f^s\delta^s+\Delta\phi_0
\end{aligned}
\end{equation}
где 
$\tau$ -- время задержки (распространения) сигнала между спутником и приёмником;
$\Delta\phi_0=\phi_{0,r}-\phi_0^s$.
Для простоты $\phi_{0,r}$ и $\phi_0^s$ можно выбрать в качестве опорных точек, т.е. положить $\phi_{0,r}=\phi_0^s=0$, тем самым устранить слагаемое $\Delta\phi_0$.

Согласно выражению \eqref{eq-carriers}, частоты $f_r$ и $f^s$ получаются приёмником и спутником при помощи атомного тактового генератора на основе номинальной частоты $f_0$.
Поэтому вклад слагаемого $(f_r-f^s)t$ пренебрежимо мал и составляет порядка $10^{-14}$.  
В силу цикличности фазы, частоты $f_r$ и $f^s$ могут быть просто аппроксимированы частотой $f_0$.
Таким образом, выражение \eqref{eq-dphi} сводится к виду:
\begin{equation}
\Delta \phi_r^s=f_0\tau+f_0(\delta_r-\delta^s)    
\end{equation}

Когда приёмник измеряет фазу несущей, он способен различить только часть текущего полного цикла фаза.
Иными словами, приёмник не знает какое целое число полных циклов $N$ проделала фаза сигнала до момента приёма.
Этот явление называется \textit{фазовой неопределённостью}.
В соответствии с этим, полная фаза несущей выражается как:
\begin{equation}
\Phi_r^s=\Delta \phi_r^s+N=f_0\tau+f_0(\delta_r-\delta^s)+N    
\end{equation}

Произведение $\Phi_r^s$ и длины волны несущей сигнала $\lambda$ эквивалентно расстоянию между приёмником и спутником:
\begin{equation}
\label{eq-cr}
\lambda\Phi_r^s=c\tau+c(\delta_r-\delta^s)+\lambda N    
\end{equation}
где
$c=f_0\lambda$.

Измерения фазы несущей также подвержены различным ошибкам $e_r^s$.
Если учесть этот факт, а также сравнить выражения \eqref{eq-pr} и \eqref{eq-cr}, то расстояние между приёмником и спутником будет равно:
\begin{equation}
\label{eq-cr2}
\lambda\Phi_r^s=R_r^s+\lambda N+e_r^s
\end{equation}

Чтобы фаза несущей могла использоваться для позиционирования, фазовая неопределённость должна быть устранена (например, при помощи фильтра Калмана).
В таком случае, точность расстояния по измерениям фазы несущей гораздо выше, чем псевдодальности, и составляет около 1\% длины волны несущей, что примерно соответствует 2 мм для L1 и 2,4 мм для L2.

\subsection*{\textbf{Доплеровский сдвиг}}

Для определения своей скорости приёмник использует доплеровский сдвиг частоты, который определяется как:
\begin{equation}
\label{eq-dopler}
f_D(t)=\frac{d\phi(t)}{dt}=\frac{v(t)}{\lambda}    
\end{equation} 
где 
$f_D(t)$ -- частота Доплера;
$\phi(t)$ -- фаза принятого сигнала;
$v(t)$ -- относительная скорость приёмника.

Если взять производную по времени обеих сторон выражения \eqref{eq-cr2}, то получится скорость приёмника относительно спутника:
\begin{equation}
\lambda D_r^s=\lambda\dot{\Phi}_r^s=\dot{R}_r^s+\dot{e}_r^s=\dot{\rho}+c(\dot{\delta}_r-\dot{\delta}^s)+\dot{e}_r^s     
\end{equation}
где 
$D_r^s$ -- измерения приёмника доплеровского сдвига;
$\dot{\delta_r}$ и $\dot{\delta^s}$ -- дрейфы часов приёмника и спутника.
Стоит отметить, что слагаемое $\lambda N$, соответствующее фазовой неопределённости, не зависит от времени, поэтому в последнем выражении отсутствует.

Измерения доплеровского сдвига также подвержены ошибкам. 
Их точность составляет около 0,001 Гц, что примерно соответствует $2\times10^{-4}\,\text{м/c}$ для L1.

В дополнении к роли определения скорости, доплеровскиё сдвиг может использоваться для позиционирования, т.е. определения расстояния.
Для этого используется величина, известная как \textit{интегральный доплеровский счёт}.
Однако она используется реже, чем измерения псевдодальности или фазы несущей, потому что требует очень стабильных осцилляторов приёмника и длительных по времени (до нескольких часов) наблюдений спутника. 