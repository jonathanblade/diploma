\section{\textsc{Комбинирование многочастотных измерений}}

Одночастотный приёмник GPS выполняет измерения только на одной частоте (например, L1) псевдодальности $R_1$, фазы несущей $\Phi_1$ и доплеровского сдвига $D_1$.
Двухчастоный приёмник, соответственно, способен выполнять измерения на двух частотах, т.е. помимо ранее упомянутых измерений на L1, ещё есть измерения на L2 ($R_2$, $\Phi_2$ и $D_2$).
Наконец, трёхчастотный приёмник может принимать сигналы на всех трёх частотах -- L1, L2 и L5. 
Следовательно, в дополнение к шести ранее упомянутым измерениям, ещё есть $R_5$, $\Phi_5$ и $D_5$. 
Комбинирование многочастотных измерений представляет собой линейные комбинации двух или более измерений на разных частотах.
Это обеспечивает некоторые преимущества при выполнении позиционирования, такие как устранение эффектов определённых источников ошибок или помощь в обнаружении срыва фазы. 
Обычно комбинируют только измерения одного типа, т.е. код-код, фаза-фаза или Доплер-Доплер, но иногда используют и другие, например, код-фаза. 

Моделирование ионосферы при помощи параметров, передаваемых в навигационном сообщении, способно устранить только около половины ионосферной ошибки.
Это обычно достаточно для стандартного позиционирования, но не для прецизионного.
Поэтому для практически полного устранения ошибки из-за задержки сигнала в ионосфере используется так называемая безионосферная линейная комбинация (Inosphere-Free Linear Combination, IFLC).

Ионосфера является дисперсионной средой.
Соответственно, сигналы разных частот распространяются с разными скоростями.
Это означает, что величина временной задержки и, следовательно, ионосферная ошибка отличается между измерениями на разных частотах.
Рассмотрим измерения псевдодальности \eqref{eq-pr2} на L1 и L2:
\begin{equation}
\label{eq-pr-2freq}
\begin{aligned}
R_1=\rho+c\delta_r+I_1 \\
R_2=\rho+c\delta_r+I_2    
\end{aligned}
\end{equation}
где 
$I_1$ и $I_2$ -- ионосферные ошибки на L1 и L2.
Остальными источниками ошибок пока можно пренебречь, т.к. они не имеют отношения к ионосфере.
Ионосферная ошибка зависит от частоты сигнала и в первом приближении может быть аппроксимирована как:
\begin{equation}
\label{eq-ion-error}
I=\frac{40,3}{f^2}\text{TEC}    
\end{equation}
Таким образом, выражения \eqref{eq-pr-2freq} можно переписать в следующем виде:
\begin{equation}
\begin{aligned}
R_1=\rho+c\delta_r+\frac{40,3}{f_1^2}\text{TEC} \\
R_2=\rho+c\delta_r+\frac{40,3}{f_2^2}\text{TEC}      
\end{aligned}
\end{equation}
Умножение обеих сторон этих выражений на квадраты соответствующих частот даёт:
\begin{equation}
\begin{aligned}
f_1^2R_1=f_1^2(\rho+c\delta_r)+40,3\text{TEC} \\
f_2^2R_2=f_2^2(\rho+c\delta_r)+40,3\text{TEC}      
\end{aligned}
\end{equation}
Если теперь вычесть второе выражение из первого, то получим:
\begin{equation}
f_1^2R_1-f_2^2R_2=(f_1^2-f_2^2)(\rho+c\delta_r)    
\end{equation}
Таким образом, стандартная форма записи IFLC на основе измерений псевдодаьностей выглядит как:
\begin{equation}
R_{IF}=\rho+c\delta_r=\frac{f_1^2R_1-f_2^2R_2}{f_1^2-f_2^2}    
\end{equation}

IFLC также может быть получена при помощи фазовых измерений сигнала.
Рассмотрим измерения фазы несущей \eqref{eq-cr2} на L1 и L2:
\begin{equation}
\label{eq-cr-2freq}
\begin{aligned}
\lambda_1\Phi_1=\rho+c\delta_r+\lambda_1N_1-I_1 \\
\lambda_2\Phi_2=\rho+c\delta_r+\lambda_2N_2-I_2   
\end{aligned}
\end{equation}
Здесь также все остальные источники ошибок пренебрежены. 
Стоит обратить внимание, что вклад ионосферной ошибки имеет другой знак.
Это связано с таким явлением, как дивергенция кодовых и фазовых измерений, которая в свою очередь обусловлена дисперсией. 
Разделив обе части выражений \eqref{eq-cr-2freq} на соответствующие длины волн и, учитывая, что $c=f\lambda$, получим:
\begin{equation}
\begin{aligned}
\Phi_1=\frac{f_1}{c}\rho+f_1\delta_r+N_1-\frac{f_1}{c}I_1 \\
\Phi_2=\frac{f_2}{c}\rho+f_2\delta_r+N_2-\frac{f_2}{c}I_2   
\end{aligned}
\end{equation}
Подставив выражение \eqref{eq-ion-error}, получим:
\begin{equation}
\begin{aligned}
\Phi_1=\frac{f_1}{c}\rho+f_1\delta_r+N_1-\frac{40,3}{cf_1}\text{TEC} \\
\Phi_2=\frac{f_2}{c}\rho+f_2\delta_r+N_2-\frac{40,3}{cf_2}\text{TEC}   
\end{aligned}
\end{equation}
Умножение обеих сторон на соответствующие частоты устраняет частотную зависимость члена ионосферной ошибки:
\begin{equation}
\begin{aligned}
f_1\Phi_1=\frac{f_1^2}{c}\rho+f_1^2\delta_r+f_1N_1-\frac{40,3}{c}\text{TEC} \\
f_2\Phi_2=\frac{f_2^2}{c}\rho+f_2^2\delta_r+f_2N_2-\frac{40,3}{c}\text{TEC}  
\end{aligned}
\end{equation}
Вычитание второго выражения из первого даёт:
\begin{equation}
f_1\Phi_1-f_2\Phi_2=(f_1^2-f_2^2)\left(\frac{\rho}{c}+\delta_r\right)+f_1N_1-f_2N_2    
\end{equation}
Учитывая, что $c=f\lambda$, то умножив обе части последнего выражения на $c$ и поделив на $f_1^2-f_2^2$ получим:
\begin{equation}
\frac{f_1^2\lambda_1\Phi_1-f_2^2\lambda_2\Phi_2}{f_1^2-f_2^2}=\rho+c\delta_r+\frac{f_1^2\lambda_1N_1-f_2^2\lambda_2N_2}{f_1^2-f_2^2}    
\end{equation}
Таким образом, стандартная форма записи IFLC на основе измерений фазы несущей определяется как:
\begin{equation}
\Phi_{IF}=\frac{f_1^2\lambda_1\Phi_1-f_2^2\lambda_2\Phi_2}{f_1^2-f_2^2}    
\end{equation} 

Из-за нескольких приближений, использующихся при выводе формулы \eqref{eq-ion-error}, IFLC всё же не полностью устраняет ионосферную ошибку.
С более точной аппроксимацией, которая учитывает ошибки высших порядков, благодаря последовательному приближению показателя преломления, можно ознакомится в \cite{Brunner1999}. 